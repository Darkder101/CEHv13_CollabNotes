# Spoofed Session Floods

## üìç Attack Classification
- **Category**: Session Layer Attack / Connection Hijacking
- **OSI Layer**: Layer 5 (Session) / Layer 4 (Transport)
- **Protocol**: TCP/UDP with session management
- **Variants**: TCP Session Floods, UDP Session Floods, Application Session Floods

## üéØ Attack Mechanism
Exploits **session management systems** by creating massive numbers of fake sessions using **spoofed identifiers**, overwhelming session tables and legitimate user access.

### How it Works:
1. **Session Creation**: Generate fake session initiation requests
2. **Identity Spoofing**: Use spoofed IP addresses or session IDs
3. **Resource Exhaustion**: Fill session tables/memory
4. **Legitimate Denial**: Block real users from creating sessions

## üîç Key Characteristics
- **Session Table Exhaustion**: Memory/storage overwhelmed
- **Spoofed Identifiers**: Fake IPs, session tokens, user agents
- **State Maintenance**: Server tracks non-existent sessions
- **Cleanup Delays**: Sessions persist until timeout

## üö® Exam Focus Points

### Critical Numbers:
- **Default Session Timeout**: 20-30 minutes (web applications)
- **Session Table Size**: 10,000-100,000+ entries
- **Memory per Session**: 1-10KB per session state
- **Attack Rate**: 100-10,000 sessions/sec

### Common Exam Questions:
- **Q**: What resource is primarily exhausted in session floods?
- **A**: Session state tables/memory
- **Q**: How do attackers make sessions appear legitimate?
- **A**: Spoof IP addresses and use valid session initiation patterns
- **Q**: What happens when session table is full?
- **A**: New legitimate sessions cannot be created

### Attack Components:
- **Session ID**: Unique identifier for session
- **Session State**: Server-side session data storage
- **Session Timeout**: Duration before cleanup
- **Authentication Bypass**: Avoiding login requirements

## ‚ö° Attack Variations

### HTTP Session Floods:
- **Method**: Create massive HTTP sessions
- **Target**: Web application session stores
- **Vector**: HTTP cookies, session tokens

### TCP Session Floods:
- **Method**: Establish many TCP connections
- **Target**: Connection-based services
- **Vector**: Application-level session management

### Database Session Floods:
- **Method**: Create database connection sessions
- **Target**: Database connection pools
- **Vector**: Connection string spoofing

### SSL/TLS Session Floods:
- **Method**: SSL handshake without completion
- **Target**: SSL session cache
- **Vector**: Partial handshake establishment

## üõ°Ô∏è Detection & Mitigation
- **Application Protection**:
  - Session rate limiting per IP
  - Session validation mechanisms
  - Reduced session timeouts
  - Session storage quotas

- **Network Protection**:
  - IP-based session limits
  - Behavioral analysis
  - CAPTCHA challenges
  - Rate limiting middleware

### Application Hardening:
```php
// PHP session protection
ini_set('session.gc_maxlifetime', 300); // 5 minute timeout
ini_set('session.cookie_httponly', 1);
ini_set('session.use_strict_mode', 1);

// Rate limiting
if (session_count_by_ip($_SERVER['REMOTE_ADDR']) > 10) {
    deny_request();
}
```

## üîß Attack Tools & Commands
- **Custom Scripts**: Session creation automation
- **Burp Suite**: Session manipulation testing
- **OWASP ZAP**: Automated session attacks
- **Curl Scripts**: HTTP session flooding

### Manual Testing:
```bash
# HTTP session flood
for i in {1..1000}; do
  curl -c "cookies_$i.txt" -b "cookies_$i.txt" \
       -H "User-Agent: Bot$i" http://target/login &
done

# Session ID brute force
for id in {1..10000}; do
  curl -H "Cookie: SESSIONID=$id" http://target/dashboard &
done
```

## üí° Historical Context
- **Early 2000s**: Web application session attacks emerge
- **E-commerce Impact**: Shopping cart session floods
- **Social Media**: Profile session exhaustion attacks
- **Modern Era**: API session flooding common

## üìä Session Attack Comparison
| Protocol | Session Storage | Impact | Complexity |
|----------|----------------|--------|------------|
| HTTP | Server memory/disk | High | Low |
| Database | Connection pool | Critical | Medium |
| SSL/TLS | SSL cache | Medium | Medium |
| WebSocket | Connection state | High | Low |

## üéØ Target Selection
Common targets:
- **Web applications** with session management
- **E-commerce sites** (shopping carts)
- **Social networks** (user profiles)
- **Banking applications** (financial sessions)
- **Gaming platforms** (player sessions)

## ‚ö†Ô∏è Vulnerable Implementations
- **Unlimited session creation**: No rate limiting
- **Long session timeouts**: Hours/days duration
- **Large session storage**: Extensive session data
- **No session validation**: Accept any session format

## üîç Detection Indicators
- **Rapid session creation**: Unusual session establishment rates
- **Memory exhaustion**: Session storage growing rapidly
- **Failed logins**: Legitimate users unable to authenticate
- **Suspicious patterns**: Similar user agents, IP ranges

### Detection Commands:
```bash
# Monitor session files (PHP)
ls /tmp/sess_* | wc -l

# Check memory usage
ps aux | grep httpd | awk '{sum += $4} END {print sum}'

# Monitor connection counts
netstat -an | grep :80 | grep ESTABLISHED | wc -l

# Session cleanup monitoring
find /var/lib/php/sessions -type f -mmin -1 | wc -l
```

## üåê Application Impact
- **Performance Degradation**: Slow response times
- **Service Unavailability**: New users cannot login
- **Resource Consumption**: Memory/disk exhaustion
- **Cascading Failures**: Backend system overload

## üí° Defense Strategy
1. **Session Limits**: Per-IP session quotas
2. **Aggressive Timeouts**: Short session lifespans
3. **Validation**: Strong session ID validation
4. **Rate Limiting**: Control session creation rate
5. **Monitoring**: Real-time session analytics

## üîß Verification Commands
```bash
# Check active sessions (Apache)
apache2ctl status | grep requests

# Monitor PHP sessions
ls /var/lib/php/sessions | wc -l

# Database connections (MySQL)
mysql -e "SHOW PROCESSLIST;" | wc -l

# Memory usage tracking
free -m && echo "Sessions: $(ls /tmp/sess_* | wc -l)"
```

## üìà Attack Metrics
- **Session Creation Rate**: 50-5000/sec
- **Memory Impact**: 1-100MB per 1000 sessions
- **Timeout Duration**: Minutes to hours
- **Cleanup Frequency**: Every 1-30 minutes

## üîÑ Modern Considerations
- **Cloud Sessions**: Distributed session stores
- **Microservices**: Service-to-service sessions
- **Mobile Apps**: Device-specific sessions
- **APIs**: Token-based session management
- **WebRTC**: Real-time session flooding
