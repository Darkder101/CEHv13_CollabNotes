# SYN Flood Attack

## üìç Attack Classification
- **Category**: Volumetric Attack (Resource Exhaustion)
- **OSI Layer**: Layer 4 (Transport)
- **Protocol**: TCP
- **Port**: Any TCP port (commonly 80, 443, 22, 25)

## üéØ Attack Mechanism
Exploits **TCP's 3-way handshake** by sending massive volumes of SYN packets with **spoofed source IPs**, exhausting server connection tables without completing handshakes.

### How it Works:
1. **SYN Flood**: Send thousands of SYN packets to target
2. **IP Spoofing**: Use randomized/spoofed source addresses
3. **Resource Exhaustion**: Fill server's connection table
4. **Handshake Never Completes**: Server waits for ACK that never comes

## üîç Key Characteristics
- **Half-Open Connections**: SYN_RECV state accumulation
- **Connection Table Exhaustion**: Backlog queue fills up
- **Spoofed Sources**: Makes filtering difficult
- **Low Bandwidth**: Relatively small packets, big impact

## üö® Exam Focus Points

### Critical Numbers:
- **Default TCP Backlog**: 128-1024 connections (varies by OS)
- **SYN Timeout**: 3-75 seconds (varies by implementation)
- **Typical Packet Size**: 40-60 bytes
- **Attack Rate**: 1,000-100,000+ SYN/sec

### Common Exam Questions:
- **Q**: What TCP connection state is exploited in SYN floods?
- **A**: SYN_RECV (half-open connection state)
- **Q**: Which part of TCP handshake is never completed?
- **A**: Final ACK from client to server
- **Q**: What server resource is primarily exhausted?
- **A**: Connection table/backlog queue

### Attack Components:
- **Target**: Server accepting TCP connections
- **SYN Packets**: TCP packets with SYN flag set
- **Spoofed IPs**: Randomized source addresses
- **Backlog Queue**: Server's pending connection storage

## ‚ö° Attack Variations
- **Direct SYN Flood**: Single source, high rate
- **Distributed SYN Flood**: Multiple sources (botnet)
- **Spoofed SYN Flood**: Randomized source IPs
- **Reflection SYN Flood**: Using innocent third parties

## üõ°Ô∏è Detection & Mitigation
- **Server-side Protection**:
  - SYN cookies implementation
  - Increase TCP backlog size
  - Reduce SYN timeout values
  - Rate limiting per IP

- **Network Protection**:
  - SYN proxy devices
  - Load balancers with SYN flood protection
  - Ingress filtering (BCP 38)
  - DDoS mitigation services

### Server Hardening:
```bash
# Linux kernel parameters
echo 1 > /proc/sys/net/ipv4/tcp_syncookies
echo 2048 > /proc/sys/net/core/netdev_max_backlog
echo 1024 > /proc/sys/net/ipv4/tcp_max_syn_backlog
echo 1 > /proc/sys/net/ipv4/tcp_syn_retries
```

## üîß Attack Tools & Commands
- **hping3**: `hping3 -S -p 80 --flood target`
- **Scapy**: Custom SYN flood scripts
- **Metasploit**: `auxiliary/dos/tcp/synflood`
- **nping**: `nping --tcp-connect -p 80 --rate 1000 target`

### Manual Testing:
```bash
# High-rate SYN flood
hping3 -S -p 80 --flood -V target_ip

# Distributed SYN flood simulation
for i in {1..100}; do hping3 -S -p 80 -a $RANDOM.$RANDOM.$RANDOM.$RANDOM target_ip & done
```

## üí° Historical Context
- **1996**: First documented SYN flood attacks
- **Panix Attack**: Early ISP taken down by SYN floods
- **2000s**: Widespread botnet SYN flooding
- **Modern Era**: Part of multi-vector DDoS attacks

## üìä Impact Comparison
| Attack Type | Bandwidth | Effectiveness | Complexity |
|-------------|-----------|---------------|------------|
| SYN Flood | Low-Medium | High | Low |
| UDP Flood | High | Medium | Very Low |
| HTTP Flood | Low | High | Medium |
| Amplification | Very High | Very High | Medium |

## üéØ Target Selection
Attackers target:
- **Web servers** (ports 80, 443)
- **Mail servers** (ports 25, 587, 993)
- **SSH servers** (port 22)
- **Database servers** (ports 3306, 1433, 5432)

## ‚ö†Ô∏è Vulnerable Implementations
- **Old TCP stacks**: Limited SYN cookie support
- **Resource-constrained devices**: IoT, embedded systems
- **Default configurations**: Small backlog queues
- **Untuned systems**: Default timeout values

## üîç Detection Indicators
- **High SYN packet rates**
- **Increasing half-open connections**
- **Connection timeouts for legitimate users**
- **netstat showing many SYN_RECV states**

### Detection Commands:
```bash
# Monitor SYN_RECV connections
netstat -an | grep SYN_RECV | wc -l

# Check TCP statistics
cat /proc/net/netstat | grep TcpExt

# Monitor connection states
ss -tan state syn-recv | wc -l
```

## üåê Internet Impact
- **Attack Frequency**: Most common DoS attack type
- **Botnet Usage**: Primary weapon in DDoS arsenals
- **Economic Impact**: Millions in downtime costs
- **Evolution**: Increasingly sophisticated variants

## üí° Defense Strategy
1. **Enable SYN Cookies**: First line of defense
2. **Tune TCP Parameters**: Optimize for expected load
3. **Implement Rate Limiting**: Per-IP connection limits
4. **Deploy DDoS Protection**: Commercial solutions
5. **Monitor Continuously**: Early detection systems

## üîß Verification Commands
```bash
# Check if SYN cookies are enabled
cat /proc/sys/net/ipv4/tcp_syncookies

# Monitor current backlog
cat /proc/sys/net/ipv4/tcp_max_syn_backlog

# Check SYN flood statistics
netstat -s | grep -i syn

# Real-time connection monitoring
watch 'netstat -an | grep :80 | grep SYN_RECV | wc -l'
```

## üìà Attack Metrics
- **Legitimate Impact Threshold**: 100-1000 SYN/sec
- **Saturation Point**: Varies by server capacity
- **Duration**: Can be sustained indefinitely
- **Recovery Time**: Immediate after attack stops (with SYN cookies)
