# 🛡️ Vulnerability Assessment Concepts

Understanding vulnerabilities is key to securing systems and applications. Vulnerability Assessment involves identifying, classifying, and addressing security weaknesses before attackers can exploit them.

---

## 🔹 Vulnerability Classification

Vulnerabilities can exist across **networks, hosts, applications, configurations, and third-party integrations**. These are commonly grouped into the following categories:

---

### 🔸 Misconfiguration / Weak Configurations

Weak or improper settings in systems can expose them to attacks.

#### ▪️ Network Misconfiguration
- **Insecure Protocols:** Using Telnet, FTP, SNMPv1 instead of secure alternatives like SSH, SFTP, SNMPv3.
- **Open Ports/Services:** Unnecessary services like SMB, RDP open to internet.
- **Errors:** Misconfigured firewalls, unfiltered error pages showing internal info.
- **Weak Encryption:** Deprecated SSL versions or insecure ciphers still in use.

#### ▪️ Host Misconfiguration
- **Open Permissions:** Over-permissive file or folder access (e.g., chmod 777).
- **Unsecured Root Accounts:** Default or no passwords, or root SSH access allowed.

---

### 🔸 Application Flaws

Software bugs that can be exploited to take control or crash systems.

- **Buffer Overflows:** Attackers write data beyond buffer boundary → remote code execution.
- **Memory Leaks:** Applications consume increasing memory → crash or slow down.
- **Resource Exhaustion:** App flooded with requests → DoS.
- **Integer Overflow:** Overflows can alter logic or enable bypasses.
- **Null Pointer/Object Dereference:** Crashes from referencing non-existent memory.
- **DLL Injection:** Malicious DLL injected into legit process → code execution.
- **Race Conditions:** Exploiting timing between resource check and use.
  - *TOC/TOU*: Classic example.
- **Improper Input Handling:** Failure to sanitize input → SQLi, XSS.
- **Improper Error Handling:** Full error messages or stack traces shown to users.
- **Code Signing Weakness:** Malicious code signed with weak or stolen certs.

---

### 🔸 Poor Patch Management

Failure to update components leaves systems vulnerable to known exploits.

- **Unpatched Servers:** Still vulnerable to CVEs (e.g., EternalBlue).
- **Unpatched Firmware:** Exploitable flaws in IoT, routers, etc.
- **Unpatched OS/Apps:** Missing security updates → open to remote attacks.

---

### 🔸 Design Flaws

Security wasn't considered in the original architecture (e.g., storing passwords without hashing).

---

### 🔸 Third-Party Risks

Risks introduced via vendors, partners, and external services.

#### ▪️ Vendor Management
- **System Integration:** Insecure code or libraries from vendors.
- **Lack of Vendor Support:** No patches, slow response times.

#### ▪️ Supply Chain Risks
- Attackers compromise components during development or delivery.

#### ▪️ Outsourced Code Development
- Developers may lack security practices → insert bugs/backdoors.

#### ▪️ Data Storage
- Sensitive data stored without encryption or in public clouds.

#### ▪️ Cloud vs On-Prem Risks
- Cloud misconfig (e.g., open S3 buckets), weak IAM, or improper segregation.

---

## 🔹 Vulnerability Scoring Systems & Databases

Helps prioritize vulnerabilities based on severity and exploitability.

### 🔸 CVSS – Common Vulnerability Scoring System
- **Base Metrics:**
  - *Exploitability*: Access complexity, required privileges, etc.
  - *Impact*: Effect on CIA triad.
- **Threat Metrics:** Exploit availability, attack trends.
- **Environmental Metrics:** Context-based scoring for organization-specific risk.
- **Supplemental Metrics:** Extra attributes for better analysis.

**Score Ranges:**
- 0.0 – None  
- 0.1–3.9 – Low  
- 4.0–6.9 – Medium  
- 7.0–8.9 – High  
- 9.0–10 – Critical

### 🔸 CVE – Common Vulnerabilities and Exposures
- Unique ID for every publicly known vulnerability.
- Managed by MITRE; format: `CVE-YYYY-NNNN`.

### 🔸 NVD – National Vulnerability Database
- US government repository that adds analysis (CVSS, patches) to CVEs.

### 🔸 CWE – Common Weakness Enumeration
- Catalog of software weaknesses (e.g., CWE-79 XSS, CWE-89 SQLi).

---

## 🔹 Vulnerability Management Life Cycle

Process of identifying, prioritizing, and fixing vulnerabilities.

### 🔸 Pre-Assessment Phase
- **Identify Assets:** List all hardware, software, and network components.
- **Create Baseline:** Define expected secure state of each asset.

### 🔸 Vulnerability Assessment Phase
- **Vulnerability Scan:** Automated tools detect known weaknesses.
- **Vulnerability Analysis:** Interpret results, remove false positives, categorize risks.

### 🔸 Post-Assessment Phase
- **Risk Assessment:** Determine severity and likelihood of exploitation.
- **Remediation:** Fix issues via patching, configuration, or updates.
- **Verification:** Re-scan to confirm vulnerabilities are resolved.
- **Monitoring:** Continuous assessment to catch new issues.

---

## 🔹 Vulnerability Research

Constantly updating knowledge on new threats is crucial.

### 🔸 Resources for Vulnerability Research
- **MSRC:** Microsoft Security Response Center – patch notes and advisories.
- **Other Resources:**
  - [Exploit-DB](https://www.exploit-db.com/)
  - [Zero Day Initiative](https://www.zerodayinitiative.com/)
  - [SecurityFocus](https://www.securityfocus.com/)
  - [HackerOne Reports](https://hackerone.com/hacktivity)

---

## 🔹 Vulnerability Scanning and Analysis

Technique used to identify vulnerabilities using scanning tools.

### 🔸 Active Scanning
- Probes sent to systems → detailed info but may cause disruptions.
- Tools: Nessus, OpenVAS.

### 🔸 Passive Scanning
- Analyzes network traffic without injecting packets → stealthy but limited.

### 🔸 Limitations of Scanning
- May miss zero-days.
- False positives.
- Needs manual validation for accuracy.

---

## 🔹 Types of Vulnerability Scanning

- **Network Scanning:** Checks for open ports, services, protocols.
- **Host-based Scanning:** Agent-based deep checks into OS and configurations.
- **Application Scanning:** Focuses on web apps and OWASP Top 10 issues.
- **Wireless Scanning:** Detects rogue access points, weak encryption.
- **Database Scanning:** Checks for default creds, unpatched DB engines.

---

**Tip:** For CEH theory, focus on knowing what each scanning method is, types of flaws under each vulnerability category, CVSS scoring components, and lifecycle steps.

